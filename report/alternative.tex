\chapter{Supermodularity and subadditivity on the majorization lattice} \label{chap:alternative}

This chapter proves some of the mathematical properties of Shannon entropy we will use extensively in the following chapters, and is thus of interest for the study of quantum applications of the majorization lattice. In particular, we show alternative proofs of supermodularity and subadditivity, which often come up when working with entropic distances and thus appear a lot in Chapter \ref{chap:incomparability}.

\section{Concatenations, sum-convex and sum-concave functions}

We will work with concatenated probability vectors. We will need the following definitions for the main theorems of the following sections.

\begin{definition}[Probability vector concatenation] \label{def:concatenation}
    Let $p, q \in \mathcal{P}^d$, then the ordered concatenation of $p$ and $q$, $\text{concat}(p, q)$, is defined as
    \begin{align}
        \text{concat}(p, q) = (p_1, p_2, ..., p_d, q_1, q_2, ..., q_d)^\downarrow \in \mathbb{R}^{2d},
    \end{align}
    and so $S^\downarrow_{2d}(\text{concat}(p, q)) = 2$.
\end{definition}

\begin{definition}[Sum-convex function] \label{def:sum-convex} % chercher si ca existe deja dans la litterature
    Let $F: \mathcal{P}^n \rightarrow \mathbb{R}$. $F$ is sum-convex if there exists a convex function $\phi: [0, 1] \rightarrow \mathbb{R}$ such that
    \begin{equation} \label{eq:sum-convex}
        F(p) = \sum_i \phi(p_i)
    \end{equation}
\end{definition}

\begin{definition}[Sum-concave function] \label{def:sum-concave} % chercher si ca existe deja dans la litterature
    Let $F: \mathcal{P}^n \rightarrow \mathbb{R}$. $F$ is sum-concave if there exists a concave function $\varphi: [0, 1] \rightarrow \mathbb{R}$ such that
    \begin{equation} \label{eq:sum-concave}
        F(p) = \sum_i \varphi(p_i)
    \end{equation}
\end{definition}

\noindent Alternatively, $F$ is sum-concave if $-F$ is sum-convex. Moreover, note that lemma \ref{lem:karamata} implies that all sum-convex functions (resp. sum-concave) are Schur-convex (resp. Schur-concave).



\section{Supermodularity of all sum-concave functions} \label{sec:alternative_supermodularity}

\subsection{Main statement}

\begin{theorem}[Supermodularity of all sum-concave functions] \label{th:alternative_supermodularity}
    All sum-concave functions $F$ are supermodular on the majorization lattice\footnote{It is important to specify which lattice, because a different lattice means a different ordering and different meet and join operations, leading to different properties. For example, on the boolean lattice, the Shannon entropy is \textit{submodular} instead \cite{cicalese_supermodularity_2002}.} for all $p, q \in \mathcal{P}^d$ such that $\beta(p, q) = p \vee q$ (as defined in (\ref{eq:beta})). For those vectors, we have
    \begin{equation} \label{eq:supermodularity}
        F(p \wedge q) + F(p \vee q) \geq F(p) + F(q).
    \end{equation}
    Note that if $p \sim q$, there is trivially equality. Moreover, in dimension 3, $\beta(p, q) = p \vee q$ is always true.
\end{theorem}

\begin{proof} \label{proof:alternative_supermodularity}
    We will prove the slightly stronger result on $\beta(p, q)$ as defined in (\ref{eq:beta}):
    \begin{equation} \label{eq:beta_supermodularity}
        F(p \wedge q) + F(\beta(p, q)) \geq F(p) + F(q).
    \end{equation}
    Let us define\footnote{Credit must be given to OpenAI's o4-mini LLM for the idea of constructing such concatenated vectors. After digging, it turns out that similar techniques are used in Ref. \cite[pp. 133--136]{marshall_inequalities_2011}, where non-trivial vector constructions are also used to prove convexity results.}
    \begin{gather}
        r = p \wedge q, \; s = \beta(p, q), \\
        A = \text{concat}(p, q) \in \mathbb{R}^{2d}, \\
        B = \text{concat}(r, s) \in \mathbb{R}^{2d},
    \end{gather}
    where $\text{concat}(\cdot, \cdot)$ is the ordered concatenation of two vectors. We have $\sum_{i=1}^{2d} A_i = \sum_{i=1}^{2d} B_i = 2$. We will now show that $A \succ B$. To do so, we need to show that the majorization inequalities (cf. definition \ref{def:majorization}) are satisfied for each $k \leq 2d$. Clearly, the $k^{\text{th}}$ cumulative sum of $A$ is made up of the first entries of $p$ and $q$, and the same goes for cumulative sums of $B$ being made of the first entries of $r$ and $s$. To avoid ill-defined terms, we additionally introduce the convention that $S^\downarrow_k (v) = 1 \; \forall k > d$ for any $d$-dimensional probability vector $v$. For each $k \leq 2d$, we have
    \begin{gather}
        S^\downarrow_k (A) = \max_{0\leq l\leq k} \left(S^\downarrow_l (p) + S^\downarrow_{k-l} (q)\right), \\
        S^\downarrow_k (B) = \max_{0\leq m\leq k} \left(S^\downarrow_{k-m} (r)+ S^\downarrow_m (s)\right). \label{eq:max_supermod}
    \end{gather} % si plusieurs l ou m sont possibles c'est pas grave pck on a quand meme le max de la somme je pense
    Recall equations (\ref{eq:alpha_bis}) and (\ref{eq:beta_bis}), from which we immediately deduce\footnote{This is the step where the $\beta(p, q) = p \vee q$ limitation comes into play: the expression in terms of maxima of cumulative sums of $\beta(p, q)$ was defined with the unordered vector, but majorization relations require the ordered vector. As such, we cannot use the maximum relation directly if $\beta(p, q) \neq \beta^\downarrow(p, q)$, on which this proof hinges.}
    \begin{gather}
        S^\downarrow_i (r) = \min \left\{S^\downarrow_i (p), S^\downarrow_i (q)\right\}, \\
        S^\downarrow_i (s) = \max \left\{S^\downarrow_i (p), S^\downarrow_i (q)\right\}.
    \end{gather} 
    Let us call the value of $m$ that realizes the maximum of eq. (\ref{eq:max_supermod}) $m'$. There are two possible cases, either $S^\downarrow_{m'} (p) \geq S^\downarrow_{m'} (q)$ or $S^\downarrow_{m'} (p) \leq S^\downarrow_{m'} (q)$. Let us consider the $S^\downarrow_{m'} (p) \geq S^\downarrow_{m'} (q)$ case, which gives us
    \begin{align}
        S^\downarrow_k (B) &= \min \left\{S^\downarrow_{k-m'} (p), S^\downarrow_{k-m'} (q)\right\} + S^\downarrow_{m'} (p) \\
        &\leq S^\downarrow_{m'} (p) + S^\downarrow_{k-m'} (q) \\
        &\leq \max_{0\leq l\leq k} \left(S^\downarrow_l (p) +S^\downarrow_{k-l} (q)\right) = S^\downarrow_k (A),
    \end{align}
    which is precisely one inequality of the majorization relation for a specific $k$. The $S^\downarrow_{m'} (p) \leq S^\downarrow_{m'} (q)$ case being symmetric, and this being true for all $k \leq 2d$, we have shown that $A \succ B$.
    Using Lemma \ref{lem:karamata} on $\varphi$ ($-\varphi$ being convex on the same interval), we get
    \begin{equation} \label{eq:supermodularity_karamata_step}
        \sum_{i=1}^{2d} \varphi(A_i) \leq \sum_{i=1}^{2d} \varphi(B_i).
    \end{equation}
    By the sum nature of $F$, the LHS of (\ref{eq:supermodularity_karamata_step}) is precisely $F(p) + F(q)$, and the RHS is precisely $F(p \wedge q) + F(\beta(p, q))$, so we have proven (\ref{eq:beta_supermodularity}) which implies (\ref{eq:supermodularity}). \qedhere
\end{proof}

\subsection{Corollaries and main conjecture}

Of course, the corollary we care the most about is the supermodularity of Shannon entropy. We will not write it here however, because Theorem \ref{th:shannon_supermodularity} is stronger than a corollary we can build from theorem \ref{th:alternative_supermodularity} (because of the limiting $\beta(p, q) = p \vee q$ condition).

However, the above proof can be reused for a sum-convex function $f$ (because $-f$ is sum-concave) by simply reversing the final Karamata inequality, giving the following corollary.

\begin{corollary}[Submodularity of all sum-convex functions] \label{cor:submodularity_sum-convex}
    All sum-convex functions $F$ are submodular on the majorization lattice for all $p, q \in \mathcal{P}^d$ such that $\beta(p, q) = p \vee q$ (as defined in (\ref{eq:beta})). For those vectors, we have
    \begin{equation} \label{eq:submodularity}
        F(p \wedge q) + F(p \vee q) \leq F(p) + F(q).
    \end{equation}
    Note that if $p \sim q$, there is trivially equality. Moreover, in dimension 3, $\beta(p, q) = p \vee q$ is always true.
\end{corollary}

Another interesting corollary is that the exponential of R\'enyi entropies $2^{H_\alpha}$ can be expressed as sum-concave or sum-convex functions too (depending on the parameter $\alpha$). This is simply because $2^{H_\alpha} = 2^{\frac{1}{1-\alpha}\log \sum_{i}p_i^\alpha} = 2^{\frac{1}{1-\alpha}} \sum_{i}p_i^\alpha$, which is clearly sum-concave if $\alpha < 1$ and sum-convex if $\alpha > 1$.

\begin{corollary}[Supermodularity of the exponential of $\alpha < 1$ Rényi entropies] \label{cor:renyi_leq_1}
    The exponential of Rényi entropy functions $2^{H_\alpha}$ of order $\alpha < 1$ are supermodular on the majorization lattice for all $p, q \in \mathcal{P}^d$ such that $\beta(p, q) = p \vee q$, for which we have
    \begin{equation} \label{eq:supermodularity_renyi}
        2^{H_\alpha(p \wedge q)} + 2^{H_\alpha(p \vee q)} \geq 2^{H_\alpha(p)} + 2^{H_\alpha(q)}.
    \end{equation}
    Note that if $p \sim q$, there is trivially equality.
\end{corollary}

\begin{corollary}[Submodularity of the exponential of $\alpha > 1$ Rényi entropies] \label{cor:renyi_geq_1}
    The exponential of Rényi entropy functions $2^{H_\alpha}$  of order $\alpha > 1$ are submodular on the majorization lattice for all $p, q \in \mathcal{P}^d$ such that $\beta(p, q) = p \vee q$, for which we have
    \begin{equation} \label{eq:submodularity_renyi}
        2^{H_\alpha(p \wedge q)} + 2^{H_\alpha(p \vee q)} \leq 2^{H_\alpha(p)} + 2^{H_\alpha(q)}.
    \end{equation}
    Note that if $p \sim q$, there is trivially equality.
\end{corollary}

\noindent Theorem \ref{th:alternative_supermodularity} is a generalization of supermodularity to a broader class of functions. However, the condition $\beta(p, q) = p \vee q$ is limiting. Numerical testing seems to indicate that the relation $A \succ B$ holds even in cases where $\beta(p, q) \neq \beta^\downarrow(p, q)$ (and so $\beta^\downarrow$ must be smoothed to get the join), which yields the first conjecture of this master thesis.

\begin{conjecture} \label{conj:alternative_supermodularity}
    All sum-concave functions $F$ are supermodular on the majorization lattice, and so for all $p, q \in \mathcal{P}^d$,
    \begin{equation}
        F(p \wedge q) + F(p \vee q) \geq F(p) + F(q).
    \end{equation}
    Note that if $p \sim q$, there is trivially equality.
\end{conjecture}



\section{Subadditivity of all sum-concave functions} \label{sec:alternative_subadditivity}

\subsection{Main statement}

Thankfully, in the case of subadditivity we are not bound by a $\beta(p, q) = p \vee q$ condition, because we will not make use of the join at all during the proof. We therefore have a form of subadditivity that is applicable to more functions than Cicalese and Vaccaro's original theorem. Moreover, the $d$-dimensional certain distribution $\overline{\delta}_d = (1, 0, \dots, 0)$ also appears in the proof, and so our theorem is actually a slightly stronger form of subadditivity.

\begin{theorem}[Subadditivity of all sum-concave functions] \label{th:alternative_subadditivity}
    All sum-concave functions $F$ are subadditive on the majorization lattice for all $p, q \in \mathcal{P}^d$. Formally,
    \begin{equation} \label{eq:subadditivity}
        F(p \wedge q) \leq F(p) + F(q) - F(\overline{\delta}_d).
    \end{equation}
\end{theorem}

\begin{proof}
    Let $p, q \in \mathcal{P}^d$. Define 
    \begin{gather}
        r = p \wedge q,\\
        A = \text{concat}(p, q),\\
        B = \text{concat}(\overline{\delta}_d, r),
    \end{gather}
    where $\text{concat}(\cdot, \cdot)$ is the ordered concatenation of two vectors. We have $\sum_{i=1}^{2d} A_i = \sum_{i=1}^{2d} B_i = 2$. We will now show that the majorization precursor $A \prec B$ is true. Clearly, the $k^{\text{th}}$ cumulative sum of $A$ is made up of the first entries of $p$ and $q$, and the same goes for cumulative sums of $B$ being made of the first entries of $r$ and $\overline{\delta}_d$. To avoid ill-defined terms, we additionally introduce the convention that $S^\downarrow_k (v) = 1 \; \forall k > d$ and $S^\downarrow_0(v) = 0$ for any $d$-dimensional probability vector $v$. For all $k \leq 2d$, we have
    \begin{gather}
        S^\downarrow_k (A) = \max_{l\leq k} \left(S^\downarrow_l (p) + S^\downarrow_{k-l} (q)\right), \\
        S^\downarrow_k (B) = 1 + S^\downarrow_{k-1}(r).
    \end{gather} % si plusieurs l ou m sont possibles c'est pas grave pck on a quand meme le max de la somme je pense
    Recall equation (\ref{eq:alpha_bis}), from which we immediately deduce
    \begin{equation}
        S^\downarrow_i (r) = \min \left\{S^\downarrow_i (p), S^\downarrow_i (q)\right\}.
    \end{equation}
    We need to show that the majorization inequalities (cf. definition \ref{def:majorization}) are satisfied for each $k \leq 2d$. First, we directly see that for $k = 1$, we have $S^\downarrow_1(B) = 1 \geq S^\downarrow_1(A) = \max \{p_1, q_1\}$. 
    
    Now, for $k \geq 2$, there are several cases depending on the value of $l$, which ranges from $0$ to $k$. Having no knowledge over $p$ and $q$, we must consider several cases separately.
    \begin{enumerate}
        \item \underline{$l = 0$}: we have \label{case:0}
        \begin{equation}
            S^\downarrow_k(B) \geq 1 \geq S^\downarrow_k(q).
        \end{equation}
        \item \underline{$l = k$}: symmetric to the $l = 0$ case, because \label{case:k}
        \begin{equation}
            S^\downarrow_k(B) \geq 1 \geq S^\downarrow_k(p).
        \end{equation}
    \end{enumerate}
    For the remaining cases, we first do the following manipulation
    \begin{align}
        S^\downarrow_k(B) &= 1 + \min \left\{S^\downarrow_{k-1}(p), S^\downarrow_{k-1}(q)\right\}\\
                          &\geq \max \left\{S^\downarrow_{k-1}(p), S^\downarrow_{k-1}(q)\right\} + \min \left\{S^\downarrow_{k-1}(p), S^\downarrow_{k-1}(q)\right\} \label{eq:subadditivity_max_trick}\\
                          &= S^\downarrow_{k-1}(p) + S^\downarrow_{k-1}(q),
    \end{align}
    where we have used the fact that the cumulative sum of any $d$-dimensional vector is always less or equal to 1 to write equation (\ref{eq:subadditivity_max_trick}). Therefore, for the majorization relation $S^\downarrow_k(B) \geq S^\downarrow_k(A)$ to be verified, it is enough to show that for any choice of $l$ that we haven't treated yet,
    \begin{align}
                          S^\downarrow_{k-1}(p) + S^\downarrow_{k-1}(q) &\geq \max_{l \leq k} \left(S^\downarrow_l (p) + S^\downarrow_{k-l} (q)\right)\\
                                                                        \iff 0 &\geq \max_{l \leq k} \left(S^\downarrow_l (p) - S^\downarrow_{k-1}(p) + S^\downarrow_{k-l} (q) - S^\downarrow_{k-1}(q)\right), \label{eq:subadditivity_leq}
    \end{align}
    and so the majorization inequality is satisfied if we show that the RHS of eq. (\ref{eq:subadditivity_leq}) is less than or equal to 0.
    \begin{enumerate}[resume]
        \item \underline{$l = 1$}: eq. (\ref{eq:subadditivity_leq}) becomes \label{case:1}
        \begin{equation}
            S^\downarrow_1(p) - S^\downarrow_{k-1}(p) \leq 0,
        \end{equation}
        which is verified $\forall k \geq 2$.
        \item \underline{$l = k - 1$}: symmetric to the $l = 1$ case, because eq. (\ref{eq:subadditivity_leq}) becomes \label{case:k-1}
        \begin{equation}
            S^\downarrow_1(q) - S^\downarrow_{k-1}(q) \leq 0,
        \end{equation}
        which is verified $\forall k \geq 2$.
        \item \underline{$2 \leq l \leq k-2$}: this case can only arise for $k \geq 4$, otherwise the inequality allows no $l$ value\footnote{This is not an issue because if $k=2$, $l \in \{0, 1, 2\}$, and if $k = 3$, $l \in \{0, 1, 2, 3\}$. All of these possibilities fall under cases \ref{case:0}, \ref{case:k}, \ref{case:1} or \ref{case:k-1}, thus all possible cases are taken into account.}. We have both \label{case:rest}
        \begin{equation}
            S^\downarrow_l (p) \leq S^\downarrow_{k-1}(p) \quad \text{and} \quad S^\downarrow_{k-l} (q) \leq S^\downarrow_{k-1}(q),
        \end{equation}
        which are both true $\forall k \geq 4$, and so eq. (\ref{eq:subadditivity_leq}) is verified. % peut-etre pas turbo clair jsp comment l'expliquer autrement
    \end{enumerate}
    Therefore, no matter the value of $l$, the majorization inequalities are satisfied $\forall k \leq 2d$. We have thus shown that $B \succ A$.
    Using Lemma \ref{lem:karamata} on $\varphi$ ($-\varphi$ being convex on the same interval), we get
    \begin{equation} \label{eq:subadditivity_karamata_step}
        \sum_{i=1}^{2d} \varphi(A_i) \geq \sum_{i=1}^{2d} \varphi(B_i).
    \end{equation}
    By the sum nature of $F$, the LHS of (\ref{eq:supermodularity_karamata_step}) is precisely $F(p) + F(q)$, and the RHS is precisely $F(p \wedge q) + F(\overline{\delta}_d)$, which we can rearrange into
    \begin{equation}
        F(p \wedge q) \leq F(p) + F(q) - F(\overline{\delta}_d).
    \end{equation}
\end{proof}

It is interesting to note that the appearance of the additional term $F(\overline{\delta}_d)$ makes this theorem stronger than a subadditivity property. In the case of Shannon entropy, the additional term simply vanishes, because the entropy of the certain distribution $\overline{\delta}_d$ is 0, however for other sum-concave functions that are not 0 for the certain distribution, this is a better upper bound than simple subadditivity.



\subsection{Corollaries}

Theorem \ref{th:shannon_subadditivity} concerning the subadditivity of $H$ becomes a corollary of theorem \ref{th:alternative_subadditivity}, because $H$ is sum-concave from its definition.

Just like with supermodularity, the above proof can be reused for a sum-convex function $f$ (because $-f$ is sum-concave) by simply reversing the final Karamata inequality, giving the following corollary.

\begin{corollary}[Superadditivity of all sum-convex functions] \label{cor:superadditivity_sum-convex}
    All sum-convex functions $F$ are superadditive on the majorization lattice for all $p, q \in \mathcal{P}^d$. Formally,
    \begin{equation} \label{eq:superadditivity}
        F(p \wedge q) \geq F(p) + F(q) - F(\overline{\delta}_d).
    \end{equation}
\end{corollary}

Theorem \ref{th:alternative_subadditivity} also implies corollaries analoguous to \ref{cor:renyi_leq_1} and \ref{cor:renyi_geq_1} for subadditivity and superadditivity of the exponential of Rényi entropies of order $\alpha < 1$ and $\alpha > 1$, respectively.



\section{Discussion}

We have proven that properties akin to supermodularity and subadditivity hold for a broader class of functions than Shannon entropy. Some sum-concave functions is used in recent litterature, particularly the subset of \textit{separable, piecewise-linear, concave} (SPLC) utilities (which is a subset of the class of sum-concave functions) in the theory of market equilibria in economics and algorithmic game theory \cite{vazirani_market_2011, anari_nash_2017}. Conjecture \ref{conj:alternative_supermodularity} and Theorem \ref{th:alternative_subadditivity} might then be of interest if researchers decide to study some of their probability distributions on the majorization lattice. Some game equilibria have already been studied on lattice structures \cite{agliardi_generalization_2000}, so such a prospect might be interesting.

The exponential of R\'enyi entropies has also long been studied, and inequalities and concavity results have already been shown for differential entropy \cite{rioul_information_2011, guo_generalization_2021}. Corollaries \ref{cor:renyi_leq_1} and \ref{cor:renyi_geq_1} and their subadditivity/superadditivity counterparts might be of interest in the discrete case.

We also believe that the concatenation technique used in this chapter might be of use to find new majorization precursors for existing entropic inequalities where other techniques have failed. For example, there is currently some interest in finding a majorization precursor for the entropic version of Bell inequalities from Ref. \cite{cerf_entropic_1997}, because such a majorization relation could enable deeper insight into Bell nonlocality.