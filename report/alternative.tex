\chapter{Alternative proofs of supermodularity and subadditivity}

\section{Definitions}

We will work with concatenated probability vectors. We will need the following definition for the main theorem of this section.

\begin{definition}[Probability vector concatenation]
    Let $p, q \in \mathcal{P}^d$, then the concatenation of $p$ and $q$, $\gamma(p, q)$, is defined as
    \begin{align}
        \gamma(p, q) = (p_1, p_2, ..., p_d, q_1, q_2, ..., q_d) \in \mathbb{R}^{2d},
    \end{align}
    and so $S^\downarrow_{2d}(\gamma(p, q)) = 1$.
\end{definition}

\begin{definition}[Sum-concave function] \label{def:sum-concave} % chercher si ca existe deja dans la litterature
    Let $\varphi$ be any real-valued function that is concave on $[0, 1]$. From it, we define a sum-concave function $F$ such that
    \begin{equation} \label{eq:sum-concave}
        F: \mathcal{P}^n \rightarrow \mathbb{R},  p \rightarrow \sum_i \varphi(p_i)
    \end{equation}
\end{definition}



\section{Supermodularity of all sum-concave functions} \label{sec:alternative_supermodularity}

\begin{theorem}[Supermodularity of all sum-concave functions] \label{th:alternative_supermodularity}
    All sum-concave functions $F$ are supermodular on the majorization lattice if $\beta(p, q) = \beta^\downarrow(p, q)$ (as defined in (\ref{eq:beta}))\footnote{It is important to specify which lattice, because a different lattice means a different ordering and different meet and join operations, leading to different properties. For example, on the boolean lattice, the Shannon entropy is \textit{submodular} instead.}, and so for all $p, q \in \mathcal{P}^d$,
    \begin{equation} \label{eq:supermodularity}
        F(p \wedge q) + F(p \vee q) \geq F(p) + F(q).
    \end{equation}
    Note that if $p \sim q$, there is trivially equality. Moreover, in dimension 3, $\beta(p, q) = \beta^\downarrow(p, q)$ is always true.
\end{theorem}

\begin{proof} \label{proof:alternative_supermodularity}
    Of the 2 properties, this is the most useful one, so let us go through the proof. We will prove the slightly stronger result on $\beta(p, q)$ as defined in (\ref{eq:beta}):
    \begin{equation} \label{eq:beta_supermodularity}
        F(p \wedge q) + F(\beta(p, q)) \geq F(p) + F(q).
    \end{equation}

    The original proof only concerned Shannon entropy (which is of the form (\ref{eq:sum-concave}) with $\varphi(x) = -x \log x$), is quite long and hinges on unintuitive index tricks, however the first result of this master thesis is to show an alternative, shorter and stronger proof of eq. (\ref{eq:beta_supermodularity}). Define\footnote{Credit must be given to OpenAI's o4-mini LLM for the idea of constructing such concatenated vectors.}
    \begin{gather}
        r = p \wedge q, \; s = \beta(p, q), \\
        A = (p_1, p_2, \dots, p_d, q_1, q_2, \dots, q_d)^\downarrow \in \mathbb{R}^{2d}, \\
        B = \gamma(r, s) \in \mathbb{R}^{2d},
    \end{gather}
    where $\gamma$ is the order-preserving concatenation of two vectors. We have $\sum_{i=1}^{2d} A_i = \sum_{i=1}^{2d} B_i = 2$. We will now show that $A \succ B$. Clearly, the $k^{\text{th}}$ cumulative sum of $A$ is made up of the first entries of $p$ and $q$, and the same goes for cumulative sums of $B$ being made of the first entries of $r$ and $s$. To avoid ill-defined terms, we additionally introduce the convention that $S^\downarrow_k (v) = 1 \; \forall k > d$ for any $d$-dimensional probability vector $v$. For all $k \leq 2d$, we have
    \begin{gather}
        S^\downarrow_k (A) = \max_{l\leq k} (S^\downarrow_l (p) + S^\downarrow_{k-l} (q)), \\
        S^\downarrow_k (B) = \max_{m\leq k} (S^\downarrow_{k-m} (r)+ S^\downarrow_m (s)).
    \end{gather} % si plusieurs l ou m sont possibles c'est pas grave pck on a quand meme le max de la somme je pense
    Recall equations (\ref{eq:alpha_bis}) and (\ref{eq:beta_bis}), from which we immediately deduce\footnote{This is the step where the $\beta(p, q) = \beta^\downarrow(p, q)$ limitation comes into play: the expression in terms of maxima of cumulative sums of $\beta(p, q)$ was defined with the unordered vector, but majorization relations require the ordered vector. As such, we cannot use the maximum relation directly if $\beta(p, q) \neq \beta^\downarrow(p, q)$, on which this proof hinges.}
    \begin{gather}
        S^\downarrow_i (r) = \min \{S^\downarrow_i (p), S^\downarrow_i (q)\}, \\
        S^\downarrow_i (s) = \max \{S^\downarrow_i (p), S^\downarrow_i (q)\}.
    \end{gather} 
    Let us fix $m$. There are two possible cases, either $S^\downarrow_m (p) \geq S^\downarrow_m (q)$ or $S^\downarrow_m (p) \leq S^\downarrow_m (q)$. Let us consider the $S^\downarrow_m (p) \geq S^\downarrow_m (q)$ case, which gives us
    \begin{align}
        S^\downarrow_k (B) &= \min \{S^\downarrow_{k-m} (p), S^\downarrow_{k-m} (q)\} + S^\downarrow_m (p) \\
        &\leq S^\downarrow_m (p) + S^\downarrow_{k-m} (q) \\
        &\leq \max_{l\leq k} (S^\downarrow_l (p) +S^\downarrow_{k-l} (q)) = S^\downarrow_k (A),
    \end{align}
    which is precisely one inequality of the majorization relation for a specific $k$. The $S^\downarrow_m (p) \leq S^\downarrow_m (q)$ case being symmetric, and this being true for all $k \leq 2d$, we have shown that $A \succ B$.
    Using Lemma \ref{lem:karamata} on $\varphi$ ($-\varphi$ being convex on the same interval), we get
    \begin{equation} \label{eq:supermodularity_karamata_step}
        \sum_{i=1}^{2d} \varphi(A_i) \leq \sum_{i=1}^{2d} \varphi(B_i).
    \end{equation}
    But the LHS of (\ref{eq:supermodularity_karamata_step}) is precisely $F(p) + F(q)$, and the RHS is precisely $F(p \wedge q) + F(\beta(p, q))$, so we have proven (\ref{eq:beta_supermodularity}) which implies (\ref{eq:supermodularity}). \qedhere
\end{proof}

\begin{corollary}[Supermodularity of the exponential of $\alpha < 1$ Rényi entropies]
    The exponential of Rényi entropy functions $2^{H_\alpha}$ are all supermodular on the majorization lattice, and so for all $p, q \in \mathcal{P}^d$,
    \begin{equation} \label{eq:supermodularity_renyi}
        2^{H_\alpha(p \wedge q)} + 2^{H_\alpha(p \vee q)} \geq 2^{H_\alpha(p)} + 2^{H_\alpha(q)}.
    \end{equation}
    Note that if $p \sim q$, there is trivially equality.
\end{corollary}

\noindent Theorem \ref{th:alternative_supermodularity} is a generalization of supermodularity to a broader class of functions. However, the condition $\beta(p, q) = \beta^\downarrow(p, q)$ is limiting. However, numerical testing seems to indicate that the relation $A \succ B$ holds even in cases where $\beta(p, q) \neq \beta^\downarrow(p, q)$ (and so $\beta^\downarrow$ must be smoothed), which yields the first conjecture of this master thesis.

\begin{conjecture} \label{conj:alternative_supermodularity}
    All sum-concave functions $F$ are supermodular on the majorization lattice, and so for all $p, q \in \mathcal{P}^d$,
    \begin{equation}
        F(p \wedge q) + F(p \vee q) \geq F(p) + F(q).
    \end{equation}
    Note that if $p \sim q$, there is trivially equality.
\end{conjecture}


\section{Subadditivity of all sum-concave functions} \label{sec:alternative_subadditivity}

